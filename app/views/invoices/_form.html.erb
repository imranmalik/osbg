<%= nested_form_for @invoice, :html => { :class => 'form-horizontal' } do |f| %>
  <% @parent_f = f %>
    <div class="invoice_top_section">
      <div style="float:left;">
    <div class="control-group">
      <%= f.label :client_id, "Client", :class => 'control-label' %>
      <div class="controls">
        <%=collection_select :invoice, :client_id, Client.all, :id, :organization_name, {:prompt => ""},{"data-placeholder" => "Select a client...", :class => "medium chzn-select"} %><br />
        <span class="hint_text">client you want to send invoice</span>
      </div>
    </div>
    <div class="control-group">
     <%= f.label :discount_percentage, "Discount %", :class => 'control-label' %>
     <div class="controls">
     <%= f.number_field :discount_percentage, :class => 'number_field small' %><br />
       <span class="hint_text">will be applied to whole invoice amount</span>
     </div>
    </div>
  </div><!-- left -->


  <div style="float:right;">
    <div class="control-group">
      <%= f.label :invoice_number, "Invoice #", :class => 'control-label' %>
      <div class="controls">
        <%= f.text_field :invoice_number, :class => 'text_field small' %><br />
        <span class="hint_text">auto generated</span>
      </div>
    </div>
    <div class="control-group">
      <%= f.label :invoice_date, "Invoice Date", :class => 'control-label' %>
      <div class="controls">
        <%= f.text_field :invoice_date, :class => 'text_field small' %>
      </div>
    </div>
  </div><!-- rigt -->
    </div>  <!-- top section -->

  <div class="invoice_grid_wrapper">
    <table class="invoice_grid_header"><thead>
    <tr class="grid_head">
      <th class="invoice_header_items align_left" width="163">Item</th>
      <th class="invoice_header_items align_left" width="143">Description</th>
      <th class="invoice_header_items" width="75">Unit Cost</th>
      <th class="invoice_header_items" width="74">Qty</th>
      <th class="invoice_header_items" width="84">Tax1</th>
      <th class="invoice_header_items" width="84">Tax2</th>
      <th class="invoice_header_items" style="border-right:none;">Line Total</th>
    </tr>
    </thead></table>
    <table class="invoice_grid_fields" id="invoice_grid_fields" cellspacing="5" cellpadding="5">
      <%= f.fields_for :invoice_line_items, :wrapper => false %>
      <tr style="border:none;"><td class="add_line_item_row" colspan="2"><%= f.link_to_add "Add Line Item", :invoice_line_items, :class => "btn btn-inverse btn-mini" %></td></tr>
    </table>
  </div><!-- task -->

  <div class="invoice_balance">
    <table cellpadding="3" class="invoice_total">
      <tr class="sub_total_tr">
        <td>Subtotal</td>
        <td><%#= f.number_field :sub_total, :class => 'number_field',:readonly => true %>
          <%= f.hidden_field :sub_total %>
          <%= label_tag '','',:id => 'invoice_sub_total_lbl' %>
        </td>
      </tr>
      <tr>
        <td>Discount</td>
        <td><%= f.hidden_field :discount_amount %>
        <%= label_tag '','',:id => 'invoice_discount_amount_lbl' %>
        </td>
      </tr>
      <tr>
        <td>Tax</td>
        <td><%= f.hidden_field :tax_amount%>
        <%= label_tag '','', :id => 'invoice_tax_amount_lbl' %>
        </td>
      </tr>
      <tr class="invoice_total_tr">
        <td><b>Net Total</b></td>
        <td><%= f.hidden_field :invoice_total%>
          <%= label_tag '','', :id => 'invoice_total_lbl' %>
        </td>
      </tr>
    </table>
  </div> <!-- invoice balance -->

  <div class="terms_notes">
    <div class="terms_div">
      <%= f.label :terms, :class => 'txt_label' %>
      <div class="txt_controls">
        <%= f.text_area :terms, :class => 'text_area', :rows => 5 %>
      </div>
    </div><!-- terms -->


    <div class="notes_div">
      <%= f.label :notes, :class => 'txt_label', :style => "margin-left:20px;" %>
      <div class="txt_controls">
        <%= f.text_area :notes, :class => 'text_area', :rows => 5, :style => "float:right;" %>
      </div>
    </div><!-- notes -->
  </div> <!-- Terms notes -->

  <div class="control-group" style="clear:both;">

  </div>

  <div class="form-actions">
    <%= f.submit 'CREATE INVOICE', :class => 'btn btn-primary' %>
    <%= f.submit 'SAVE AS DRAFT', :class => 'btn btn-primary', :name => "save_as_draft" %>
    <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
      invoices_path, :class => 'btn' %>
  </div>
<% end %>
